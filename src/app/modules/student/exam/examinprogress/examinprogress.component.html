<div class="content" role="main">
  <div class="container">
    <div class="row">
      <div class="col-md-12 mx-auto" *ngIf="!response?.examComplete">
        <countdown #countDown 
          *ngIf="!response?.timedPerQuestion"
          [config]="{leftTime: timeLeftInSeconds}" 
          (event)="onTimerExpired($event)"
          class="text-danger text-center count-down">
            $!h!:$!m!:$!s!
        </countdown>
        <div>
          <span class="section-title">{{ response?.examSectionTransfer.sectionName }}</span>
          <div class="lighter-font">{{ response?.examSectionTransfer.description }}</div>
        </div><br>
        <mat-card class="col-md-10 mx-auto" style="padding: 2em;">
          <countdown #countDown
            *ngIf="response?.timedPerQuestion && !response?.examSectionTransfer.examQuestionTransfer.comprehensionQuestion"
            [config]="{leftTime: timeLeftInSeconds}" 
            (event)="onTimerExpired($event)"
            class="text-danger count-down">
              $!h!:$!m!:$!s!
          </countdown>
          <div style="padding-bottom: 2em;">{{ response?.examSectionTransfer.examQuestionTransfer.question }}</div>
          <form #saveAnswers="ngForm" 
            (ngSubmit)="onSubmit(saveAnswers)"
            *ngIf="!response?.examSectionTransfer.examQuestionTransfer.comprehensionQuestion">
            <div *ngIf="response?.examSectionTransfer.examQuestionTransfer.answerType !== 'Text answer'">
              <div
                *ngFor="let answer of response?.examSectionTransfer.examQuestionTransfer.answerTransfers;
                  trackBy: trackByFn let i=index"
                style="display: flex; align-items: flex-start; justify-content: flex-start;">
                <div *ngIf="response?.examSectionTransfer.examQuestionTransfer.answerType === 'Multiple choice single answer'">
                  <mat-radio-button
                    (change)="getSingleCheckedAnswer(answer.answerId)">
                  </mat-radio-button>
                </div>
                <div *ngIf="response?.examSectionTransfer.examQuestionTransfer.answerType === 'Multiple choice multiple answers'">
                  <mat-checkbox 
                    id="multiple-choice-answer-checkbox_{{i}}"
                    (change)="getMultipleCheckedAnswer($event, answer.answerId)">
                  </mat-checkbox>&nbsp;&nbsp;
                </div>
                <div class="form-group" style="width: 60%;">
                  {{ answer.answer }}
                </div>
              </div>
            </div>
            <div *ngIf="response?.examSectionTransfer.examQuestionTransfer.answerType === 'Text answer'">
              <angular-editor id="answer" 
                [config]="config"
                name="answer" 
                [(ngModel)]="answerText"
                #answer="ngModel">
              </angular-editor>
            </div>
            <div class="form-group row" style="justify-content: space-between; padding-top: 20px;">
              <button mat-raised-button 
                color="primary"
                type="submit">
                {{ 'generic/submit'| translate }}
              </button>
              <button mat-raised-button 
                color="primary"
                (click)="skipToNextQuestion()"
                type="button">
                {{ 'generic/skip'| translate }}
              </button>
              <button mat-raised-button 
                *ngIf="response?.pausable"
                color="primary"
                (click)="pauseExam()"
                type="button">
                {{ 'generic/skip'| translate }}
              </button>
            </div>
          </form>
        </mat-card><br>
        <mat-card class="col-md-9 mx-auto" 
          style="padding: 2em;"
          *ngIf="response?.examSectionTransfer.examQuestionTransfer.comprehensionQuestion">
          <countdown #countDown
            *ngIf="response?.timedPerQuestion && response?.examSectionTransfer.examQuestionTransfer.comprehensionQuestion"
            [config]="{leftTime: timeLeftInSeconds}" 
            (event)="onTimerExpired($event)"
            class="text-danger count-down">
              $!h!:$!m!:$!s!
          </countdown>
          <div style="padding-bottom: 2em;">
            {{ response?.examSectionTransfer.examQuestionTransfer.questionTransfer.question }}
          </div>
          <form #saveAnswers="ngForm" 
            (ngSubmit)="onSubmit(saveAnswers)">
            <div *ngIf="response?.examSectionTransfer.examQuestionTransfer.questionTransfer.answerType !== 'Text answer'">
              <div
                *ngFor="let answer of response?.examSectionTransfer.examQuestionTransfer.questionTransfer.answerTransfers;
                  trackBy: trackByFn let i=index"
                style="display: flex; align-items: flex-start; justify-content: flex-start;">
                <div *ngIf="response?.examSectionTransfer.examQuestionTransfer.questionTransfer.answerType === 'Multiple choice single answer'">
                  <mat-radio-button
                    (change)="getSingleCheckedAnswer(answer.answerId)">
                  </mat-radio-button>
                </div>
                <div *ngIf="response?.examSectionTransfer.examQuestionTransfer.questionTransfer.answerType === 'Multiple choice multiple answers'">
                  <mat-checkbox 
                    id="multiple-choice-answer-checkbox_{{i}}"
                    (change)="getMultipleCheckedAnswer($event, answer.answerId)">
                  </mat-checkbox>&nbsp;&nbsp;
                </div>
                <div class="form-group" style="width: 60%;">
                  {{ answer.answer }}
                </div>
              </div>
            </div>
            <div *ngIf="response?.examSectionTransfer.examQuestionTransfer.questionTransfer.answerType === 'Text answer'">
              <angular-editor id="answer" 
                [config]="config"
                name="answer" 
                [(ngModel)]="answerText"
                #answer="ngModel">
              </angular-editor>
            </div>
            <div class="form-group row" style="justify-content: space-between; padding-top: 20px;">
              <button mat-raised-button 
                color="primary"
                type="submit">
                {{ 'generic/submit'| translate }}
              </button>
              <button mat-raised-button 
                color="primary"
                (click)="skipToNextQuestion()"
                type="button">
                {{ 'generic/skip'| translate }}
              </button>
              <button mat-raised-button 
                *ngIf="response?.pausable"
                color="primary"
                (click)="pauseExam()"
                type="button">
                {{ 'generic/skip'| translate }}
              </button>
            </div>
          </form>
        </mat-card>
      </div>
      <div class="col-md-8 mx-auto" *ngIf="response?.examComplete">
        <div class="header-title">
          <h1 translate>student/exam/examinprogress/exam_complete</h1>
        </div>
        <mat-card>
          <div class="card-body">
            You have reached the end of the exam.
          </div>
        </mat-card>
      </div>
    </div>
  </div>
</div>